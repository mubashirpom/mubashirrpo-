let Leon = require('../events');
let {MessageType, MessageOptions, Mimetype} = require('@adiwajshing/baileys');
let fs = require('fs');
let axios = require('axios');
let got = require('got');
let Config = require('../config');
let td = Config.WORKTYPE == 'private' ? true : false

var STORY_DESC = "Downloads story from instagram with provided username."
var INC_UA = "*❌️ Couldn't download story! This may be because of invalid instagram username or the user hasn't updated any stories.*"
var DOWN = "```Downloading stories from:``` *{}*"
var DOWN_MEDIA = "*Downloading media...*"
var IG_DESC = "Downloads medias from instagram with provided url."
var NEED_URL = "*You must enter a instagram media url to download!*"
var INVALID_URL = "*❌️ Entered url is not valid, Please enter a valid url!*"
var IG_STALK = "Fetches the details of the instagram user with provided username."
var NEED_USERNAME = "*You must enter a instagram username!*"
var INVALID_USERNAME = "*❌️ Entered username is not valid, Please enter a valid username!*"
var ERROR = "*An unknown error occurred!*"
var UA = "Username"
var NM = "Name"
var BGY = "Biography"
var ID = "ID"
var FLWRS = "Followers"
var FLWNG = "Following"
var PST = "Posts"
if (Config.LANG == 'ML') DOWN_MEDIA = "*മീഡിയ ഡൗൺലോഡ് ചെയ്യുന്നു...*", STORY_DESC = "നൽകിയ ഉപയോക്തൃനാമം കൊണ്ട് ഇൻസ്റ്റാഗ്രാമിൽ നിന്ന് സ്റ്റോറി ഡൗൺലോഡ് ചെയ്യുന്നു.", INC_UA = "*❌️ സ്റ്റോറി ഡൗൺലോഡ് ചെയ്യാനായില്ല! ഇത് അസാധുവായ instagram ഉപയോക്തൃനാമം കൊണ്ടായിരിക്കാം അല്ലെങ്കിൽ ഉപയോക്താവ് സ്‌റ്റോറികളൊന്നും അപ്‌ഡേറ്റ് ചെയ്‌തിട്ടില്ല.*", DOWN = "*{}* ```നിന്ന് സ്റ്റോറികൾ ഡൗൺലോഡ് ചെയ്യുന്നു.```", IG_DESC = "നൽകിയ url ഉപയോഗിച്ച് instagram-ൽ നിന്ന് മീഡിയകൾ ഡൗൺലോഡ് ചെയ്യുന്നു.", NEED_URL = "*ഡൗൺലോഡ് ചെയ്യുന്നതിന് നിങ്ങൾ ഒരു instagram മീഡിയ url നൽകണം!*", INVALID_URL = "*❌️ നൽകിയ url സാധുതയുള്ളതല്ല, ദയവായി ഒരു സാധുവായ url നൽകുക!*", IG_STALK = "നൽകിയിരിക്കുന്ന ഉപയോക്തൃനാമം ഉപയോഗിച്ച് ഇൻസ്റ്റാഗ്രാം ഉപയോക്താവിന്റെ വിശദാംശങ്ങൾ ലഭ്യമാക്കുന്നു.", NEED_USERNAME = "നിങ്ങൾ ഒരു instagram ഉപയോക്തൃനാമം നൽകണം!", INVALID_USERNAME = "*❌️ നൽകിയ ഉപയോക്തൃനാമം സാധുവല്ല, ദയവായി ഒരു സാധുവായ ഉപയോക്തൃനാമം നൽകുക!*", ERROR = "*ഒരു ​​അജ്ഞാത പിശക് സംഭവിച്ചു!*", UA = "ഉപയോക്തൃനാമം", NM = "പേര്", BGY = "ബയോഗ്രാഫി", LN = "ലിങ്ക്", FLWRS = "അനുയായികൾ", FLWNG = "പിന്തുടരുന്നവർ", PST = "പോസ്റ്റുകൾ"
if (Config.LANG == 'ID') DOWN_MEDIA = "*Mengunduh media...*", STORY_DESC = "Mengunduh cerita dari instagram dengan nama pengguna yang disediakan.", INC_UA = "*❌️ Tidak dapat mengunduh cerita! Ini mungkin karena nama pengguna instagram tidak valid atau pengguna belum memperbarui cerita apa pun.*", DOWN = "```Mengunduh cerita dari:``` *{}*", IG_DESC = "നൽകിയ url ഉപയോഗിച്ച് instagram-ൽ നിന്ന് മീഡിയകൾ ഡൗൺലോഡ് ചെയ്യുന്നു.", NEED_URL = "*ഡൗൺലോഡ് ചെയ്യുന്നതിന് നിങ്ങൾ ഒരു instagram മീഡിയ url നൽകണം!*", INVALID_URL = "*❌️ നൽകിയ url സാധുതയുള്ളതല്ല, ദയവായി ഒരു സാധുവായ url നൽകുക!*", IG_STALK = "Mengambil detail pengguna instagram dengan nama pengguna yang disediakan.", NEED_USERNAME = "Anda harus memasukkan nama pengguna instagram!", INVALID_USERNAME = "*❌️ Nama pengguna yang dimasukkan tidak valid, Harap masukkan nama pengguna yang valid!*", ERROR = "*Terjadi kesalahan yang tidak diketahui!*", UA = "Nama belakang", NM = "Nama", BGY = "Biografi", LN = "Tautan", FLWRS = "Pengikut", FLWNG = "Mengikuti", PST = "Postingan"

Leon.addCommand({pattern: 'ig ?(.*)', fromMe: td, desc: IG_DESC}, (async (message, match) => {

if (match[1] !== '' && match[1].includes('?igs')) match[1] = match[1].split('?')[0]
const _0x164eb2=_0x2416;(function(_0x201b86,_0x3affda){const _0x2792ca=_0x2416,_0x2c77f4=_0x201b86();while(!![]){try{const _0x138be2=parseInt(_0x2792ca(0x132))/0x1*(parseInt(_0x2792ca(0x144))/0x2)+-parseInt(_0x2792ca(0x134))/0x3*(parseInt(_0x2792ca(0x127))/0x4)+-parseInt(_0x2792ca(0x12a))/0x5*(-parseInt(_0x2792ca(0x13d))/0x6)+-parseInt(_0x2792ca(0x143))/0x7+parseInt(_0x2792ca(0x13a))/0x8*(-parseInt(_0x2792ca(0x145))/0x9)+parseInt(_0x2792ca(0x12c))/0xa+-parseInt(_0x2792ca(0x147))/0xb*(-parseInt(_0x2792ca(0x12f))/0xc);if(_0x138be2===_0x3affda)break;else _0x2c77f4['push'](_0x2c77f4['shift']());}catch(_0x2e6be6){_0x2c77f4['push'](_0x2c77f4['shift']());}}}(_0x3ae3,0x4de88));const _0xce6e7a=_0x1a94;(function(_0x161832,_0x296c98){const _0x250633=_0x2416,_0x1aa862=_0x1a94,_0x1abf45=_0x161832();while(!![]){try{const _0x161f93=parseInt(_0x1aa862(0x119))/0x1+-parseInt(_0x1aa862(0x106))/0x2*(parseInt(_0x1aa862(0x111))/0x3)+parseInt(_0x1aa862(0x10a))/0x4+-parseInt(_0x1aa862(0x107))/0x5+parseInt(_0x1aa862(0x104))/0x6*(-parseInt(_0x1aa862(0x11b))/0x7)+parseInt(_0x1aa862(0x105))/0x8*(-parseInt(_0x1aa862(0x112))/0x9)+parseInt(_0x1aa862(0x11c))/0xa*(parseInt(_0x1aa862(0x10b))/0xb);if(_0x161f93===_0x296c98)break;else _0x1abf45[_0x250633(0x137)](_0x1abf45[_0x250633(0x146)]());}catch(_0x3a357a){_0x1abf45[_0x250633(0x137)](_0x1abf45[_0x250633(0x146)]());}}}(_0x3da7,0xa1906));if(match[0x0]['match'](_0xce6e7a(0x10f)))return;function _0x1a94(_0x165ba0,_0x223b98){const _0x21c253=_0x3da7();return _0x1a94=function(_0x558b2b,_0x1394d7){_0x558b2b=_0x558b2b-0x104;let _0x10a66f=_0x21c253[_0x558b2b];return _0x10a66f;},_0x1a94(_0x165ba0,_0x223b98);}function _0x2416(_0xee2df5,_0x380e62){const _0x3ae349=_0x3ae3();return _0x2416=function(_0x24167c,_0x596026){_0x24167c=_0x24167c-0x126;let _0x4cc54f=_0x3ae349[_0x24167c];return _0x4cc54f;},_0x2416(_0xee2df5,_0x380e62);}if(match[0x1]==='')return await message[_0xce6e7a(0x10e)](NEED_URL);let url=Config[_0x164eb2(0x139)]+_0xce6e7a(0x115)+match[0x1],res=await got(url),json=JSON[_0xce6e7a(0x116)](res[_0xce6e7a(0x113)]);function _0x3ae3(){const _0x441d16=['data','88kBgJnY','arraybuffer','/downloader/instagram?url=','5SAelDR','message','6054530pXeGnQ','sendVideo','144hQMMYm','5302884ErUVpi','result','ERROR','2xcwJmx','parse','49380GcORiQ','image','sendImage','push','34479841gAoORz','API','8iQxCkh','body','417627JYQPza','187086ozQvRf','2WdiSHK','valid','10nAEDfD','includes','1249588LxMAli','3743789gBEJCO','323794vRszzu','5653647KSGfCy','shift','22YjnjRf','3035KJiPig','6UDioZn','sendReply','2958326zXrDBH'];_0x3ae3=function(){return _0x441d16;};return _0x3ae3();}if(json[_0xce6e7a(0x110)][_0xce6e7a(0x109)](_0x164eb2(0x13f)))return await message[_0xce6e7a(0x10e)](INVALID_URL);if(json[_0xce6e7a(0x110)][_0xce6e7a(0x109)](_0xce6e7a(0x11d)))return await message[_0xce6e7a(0x10e)](ERROR);var results=json[_0x164eb2(0x130)];function _0x3da7(){const _0x43f712=_0x164eb2,_0x2c8219=[_0x43f712(0x138),'from',_0x43f712(0x128),_0x43f712(0x14a),'igs',_0x43f712(0x12b),'3209631pYUCid',_0x43f712(0x13c),_0x43f712(0x13b),'type',_0x43f712(0x129),_0x43f712(0x133),_0x43f712(0x126),_0x43f712(0x135),_0x43f712(0x148),_0x43f712(0x136),_0x43f712(0x14b),_0x43f712(0x140),_0x43f712(0x131),_0x43f712(0x149),_0x43f712(0x12e),_0x43f712(0x13e),'2302240sRRFXc','get',_0x43f712(0x141),_0x43f712(0x142)];return _0x3da7=function(){return _0x2c8219;},_0x3da7();}await message[_0xce6e7a(0x10e)](DOWN_MEDIA);for(var result of results){var media=await axios[_0xce6e7a(0x108)](result['url'],{'responseType':_0xce6e7a(0x10d)});return result[_0xce6e7a(0x114)]!==_0xce6e7a(0x118)?await message[_0x164eb2(0x12d)](Buffer[_0xce6e7a(0x10c)](media[_0x164eb2(0x126)]),''):await message[_0xce6e7a(0x11a)](Buffer[_0xce6e7a(0x10c)](media[_0xce6e7a(0x117)]),'');}
}));

Leon.addCommand({pattern: 'igs ?(.*)', fromMe: td, desc: IG_STALK}, (async (message, match) => {

const _0x231c1d=_0x51ea;(function(_0x4c6b5c,_0xdc28e6){const _0x5bba3d=_0x51ea,_0x2b355f=_0x4c6b5c();while(!![]){try{const _0x4c720c=-parseInt(_0x5bba3d(0xd3))/0x1+parseInt(_0x5bba3d(0xd7))/0x2+-parseInt(_0x5bba3d(0xe4))/0x3*(parseInt(_0x5bba3d(0xc6))/0x4)+-parseInt(_0x5bba3d(0xdb))/0x5*(-parseInt(_0x5bba3d(0xd5))/0x6)+parseInt(_0x5bba3d(0xce))/0x7*(parseInt(_0x5bba3d(0xc7))/0x8)+-parseInt(_0x5bba3d(0xda))/0x9*(-parseInt(_0x5bba3d(0xcc))/0xa)+-parseInt(_0x5bba3d(0xca))/0xb;if(_0x4c720c===_0xdc28e6)break;else _0x2b355f['push'](_0x2b355f['shift']());}catch(_0x36961f){_0x2b355f['push'](_0x2b355f['shift']());}}}(_0xf77e,0xccac6));if(match[0x1]==='')return await message[_0x231c1d(0xdd)](NEED_USERNAME);let url=Config[_0x231c1d(0xcd)]+'/stalk/instagram?username='+match[0x1],res=await got(url),json=JSON[_0x231c1d(0xdc)](res[_0x231c1d(0xd6)]);if(json[_0x231c1d(0xe3)][_0x231c1d(0xdf)]('Invalid\x20Username'))return await message[_0x231c1d(0xdd)](INVALID_USERNAME);function _0xf77e(){const _0x559ec0=['arraybuffer','message','32199VBMTHl','464iYjPfp','43720QhPWOo','_➥\x20','result','12236433JsGFVj','get','50iHluNP','API','1806rZabEA','post_count','_\x20:\x20*','name','data','272774TPVswi','sendImage','60474gAYCXU','body','2988804WovfXY','*\x0a_➥\x20','followers_count','289827iAWwww','200GNKLlr','parse','sendReply','profile_pic','includes','ERROR','bio'];_0xf77e=function(){return _0x559ec0;};return _0xf77e();}if(json[_0x231c1d(0xe3)][_0x231c1d(0xdf)](_0x231c1d(0xe0)))return await message[_0x231c1d(0xdd)](ERROR);let info=_0x231c1d(0xc8)+UA+_0x231c1d(0xd0)+json[_0x231c1d(0xc9)]['username']+_0x231c1d(0xd8)+NM+'_\x20:\x20*'+json[_0x231c1d(0xc9)][_0x231c1d(0xd1)]+'*\x0a_➥\x20'+BGY+'_\x20:\x20*'+json[_0x231c1d(0xc9)][_0x231c1d(0xe1)]+'*\x0a_➥\x20'+FLWRS+_0x231c1d(0xd0)+json[_0x231c1d(0xc9)][_0x231c1d(0xd9)]+'*\x0a_➥\x20'+FLWNG+_0x231c1d(0xd0)+json[_0x231c1d(0xc9)]['following_count']+'*\x0a_➥\x20'+PST+'_\x20:\x20*'+json['result'][_0x231c1d(0xcf)]+'*';function _0x51ea(_0x122e90,_0xe84fc){const _0xf77e50=_0xf77e();return _0x51ea=function(_0x51ea93,_0x17a7fc){_0x51ea93=_0x51ea93-0xc6;let _0x2e5642=_0xf77e50[_0x51ea93];return _0x2e5642;},_0x51ea(_0x122e90,_0xe84fc);}try{var pp=await axios[_0x231c1d(0xcb)](json['result'][_0x231c1d(0xde)],{'responseType':_0x231c1d(0xe2)});return await message[_0x231c1d(0xd4)](Buffer['from'](pp[_0x231c1d(0xd2)]),info);}catch(_0xb6b667){return await message[_0x231c1d(0xdd)](info);}
}));

Leon.addCommand({pattern: 'story ?(.*)', fromMe: td, desc: STORY_DESC}, (async (message, match) => {

const _0x52defe=_0x5b34;(function(_0x34de55,_0x37bba9){const _0x27107f=_0x5b34,_0x311414=_0x34de55();while(!![]){try{const _0x3c00c8=parseInt(_0x27107f(0x17d))/0x1+-parseInt(_0x27107f(0x16a))/0x2*(-parseInt(_0x27107f(0x181))/0x3)+-parseInt(_0x27107f(0x16b))/0x4+parseInt(_0x27107f(0x174))/0x5*(parseInt(_0x27107f(0x187))/0x6)+-parseInt(_0x27107f(0x17c))/0x7+parseInt(_0x27107f(0x170))/0x8*(parseInt(_0x27107f(0x175))/0x9)+parseInt(_0x27107f(0x178))/0xa*(-parseInt(_0x27107f(0x184))/0xb);if(_0x3c00c8===_0x37bba9)break;else _0x311414['push'](_0x311414['shift']());}catch(_0xef69dc){_0x311414['push'](_0x311414['shift']());}}}(_0x55c3,0x481d1));function _0x5b34(_0x57cba9,_0x5382e3){const _0x55c380=_0x55c3();return _0x5b34=function(_0x5b343a,_0xc03bbb){_0x5b343a=_0x5b343a-0x165;let _0x50e5ed=_0x55c380[_0x5b343a];return _0x50e5ed;},_0x5b34(_0x57cba9,_0x5382e3);}function _0x391b(){const _0x276e01=_0x5b34,_0x293ad1=[_0x276e01(0x169),'sendVideo',_0x276e01(0x185),_0x276e01(0x16d),_0x276e01(0x16c),'5wJNoPi',_0x276e01(0x17a),_0x276e01(0x186),_0x276e01(0x176),_0x276e01(0x183),_0x276e01(0x17f),_0x276e01(0x17e),_0x276e01(0x168),_0x276e01(0x179),'body',_0x276e01(0x16e),_0x276e01(0x166),'type','parse',_0x276e01(0x171),_0x276e01(0x17b),'result','2368632Kbpmhg',_0x276e01(0x172),'5404626CQwOwf',_0x276e01(0x165),'89013kOsDPf',_0x276e01(0x173),'url'];return _0x391b=function(){return _0x293ad1;},_0x391b();}const _0xf67ded=_0x4b37;function _0x55c3(){const _0x201dce=['ERROR','API','65149UpmHGg','377315saOfbT','2639620YsnDpm','11wDwaRH','arraybuffer','834816sAVesz','download\x20story','message','2453lOGZkw','16PspHfy','sendImage','6wAyaxi','data','match','shift','sendReply','880664hjSRNX','2HtxHAR','1766424XujEel','3600gPCGXR','includes','ideo','/downloader/instagram-story?username=','61776AYtxYb','853494wCsItg','replace','get','1715155ObqGgD','351OfBFiu','from','push','24820TVIkLG','7551KKmFOL'];_0x55c3=function(){return _0x201dce;};return _0x55c3();}(function(_0x507a65,_0x4e9680){const _0x365c93=_0x5b34,_0x452957=_0x4b37,_0x3ee726=_0x507a65();while(!![]){try{const _0x360b95=parseInt(_0x452957(0x18e))/0x1*(-parseInt(_0x452957(0x193))/0x2)+parseInt(_0x452957(0x1a4))/0x3+parseInt(_0x452957(0x191))/0x4*(parseInt(_0x452957(0x196))/0x5)+parseInt(_0x452957(0x18c))/0x6+-parseInt(_0x452957(0x1a7))/0x7+parseInt(_0x452957(0x195))/0x8*(parseInt(_0x452957(0x19e))/0x9)+-parseInt(_0x452957(0x19c))/0xa*(parseInt(_0x452957(0x19b))/0xb);if(_0x360b95===_0x4e9680)break;else _0x3ee726[_0x365c93(0x177)](_0x3ee726[_0x365c93(0x167)]());}catch(_0x3fe4d6){_0x3ee726['push'](_0x3ee726[_0x365c93(0x167)]());}}}(_0x391b,0x7263f));if(match[0x1]==='')return await message[_0xf67ded(0x19d)](NEED_USERNAME);let url=Config[_0xf67ded(0x1a5)]+_0x52defe(0x16f)+match[0x1],res=await got(url),json=JSON[_0xf67ded(0x1a3)](res[_0xf67ded(0x19f)]);if(json[_0x52defe(0x183)][_0xf67ded(0x194)](_0x52defe(0x182)))return await message[_0xf67ded(0x19d)](INC_UA);if(json[_0xf67ded(0x19a)][_0xf67ded(0x194)](_0xf67ded(0x197)))return await message[_0xf67ded(0x19d)](ERROR);function _0x4b37(_0x1900a7,_0x3a6686){const _0x12d99e=_0x391b();return _0x4b37=function(_0x2db754,_0x236b5b){_0x2db754=_0x2db754-0x18c;let _0x49eed6=_0x12d99e[_0x2db754];return _0x49eed6;},_0x4b37(_0x1900a7,_0x3a6686);}var results=json[_0xf67ded(0x1a6)];await message['sendReply'](DOWN[_0xf67ded(0x1a8)]('{}',match[0x1]));for(var result of results){var media=await axios[_0xf67ded(0x18f)](result[_0xf67ded(0x190)],{'responseType':_0x52defe(0x180)});result[_0xf67ded(0x1a2)][_0xf67ded(0x1a1)](_0xf67ded(0x1a0))?await message[_0xf67ded(0x192)](Buffer[_0x52defe(0x176)](media[_0xf67ded(0x18d)]),''):await message[_0xf67ded(0x198)](Buffer[_0xf67ded(0x199)](media[_0xf67ded(0x18d)]),'');}
}));
